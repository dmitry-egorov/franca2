- [ ] defs are macros by default
    - [ ] #: embedded code
    - [ ] support locals within inlined functions
- [ ] 'emit' scope
    - directly writes wasm
- [ ] var with init as macro
    - [ ] 'identifier' parameter kind
    - [ ] pass name and kind
    - [ ] local builtin
- [ ] emit a function and a call when needed
- [ ] line and column numbers for nodes
- [ ] breakable scope for loops
- [ ] +=, -=, *=, /=, %= ...
- [ ] fix display of wasm nodes (no space between ops)
- [ ] generalize funcs
    - [ ] a new param type: on stack?
    - [ ] if func is inline add external var ref
    - [ ] if func is called pass value and set var after return
- [ ] inline store_u8
    - [ ] separate display and param list
- [ ] $ -> in
- [ ] mod color of custom functions
- [ ] strings as compound types? that means a primitive can be expanded as multiple wasm consts
- [ ] inline by creating a new var at the call site or reusing a var if it's passed directly
- [ ] fix referencing locals outside a function
    - [ ] pass outside locals by reference?
- [ ] display inline wasm
    - [ ]
- [ ] move store_u8 to prelude
    - [ ] accept u8 instead of u32
    - [ ] wasm definition
- [ ] types at the end of var
- [ ] literal types
    - [ ] gather scopes and definitions as a separate pass
    - [ ] typecheck as a separate pass
    - [ ] allow literal types
- [ ] constants
    - [ ] function definitions are constants
- [ ] generalize string builder for istr
- [ ] named arguments (for default parameters)
- [ ] memory stack
    - secondary call stack, located in memory
    - used for structs and to get references to local variables
- [ ] infer types before emitting
- [ ] inline functions
    - [ ] pop from stack instead of binding to parameters
    - [ ] apply inline modifiers
- [ ] inline wasm
    - need iterative compilation?
- [ ] scrolling
- [ ] pointers
    - [ ] linear stack?
    - [ ] base memory as global variable?
- [ ] should gather defs when creating a new scope?
- [ ] inline functions? (e.g. for istr)
- [ ] lower level func def with explicit params and returns?
- [ ] rethink literal types?
- [ ] support nested func definitions? (gather recursively)
- [ ] structs
    - https://github.com/WebAssembly/tool-conventions/blob/main/BasicCABI.md
- [ ] generate an array type
- [ ] imports? to import a prelude
- [ ] navigate node tree with keyboard
- [ ] cursor
    - [ ] display blinking cursor
    - [ ] only redraw when state changes
    - [ ] move cursor
    - [ ] scroll view
- [ ] edit
- [ ] block lines
- [ ] line and col in errors
- [ ] wasm jit?

done
- [~] defs are macros by default
    - [+] $: temp local
- [~] defs are macros by default
    - emit a function and a call when needed
    - [+] remap locals
    - [+] &: reference
        - [+] remap params
- [+] determine types beforehand
    - [+] gather types for each node
    - [+] gather definitions
        - [+] macro
        - [+] scope
        - [+] funcs
    - [+] gather scopes
- [+] discriminated union of node types

- [+] node parameter #
    - [+] emit parameter explicitly in the macro
- [+] assign op
    - [+] pass variable by reference (local index)
    - [+] explicit reference to variable
    - [+] wasm ops can accept local index
- [+] wasm_def return (need overriding)
- [+] wasm_def binary ops
- [+] override functions
- [+] single emit function, polymorphic over parameter count
- [+] wasm_def
    - define pure wasm function
- [+] primitive types
    - every local has a type
    - every expression has a type
    - show error when types don't match?
    - choose arithmetic operations based on type
    - [+] specify types
        - [+] primitives test
        - [+] prelude
        - [+] others
    - [+] take type in var   defs
    - [+] take type in param defs
    - [+] take type in func  defs
    - [+] determine node type when emitting
    - [+] print different types
    - [+] parse negatives
    - [+] parse floats
    - [+] print floats
- [+] identifier node type, and get rid of &[x] everywhere
- [+] chars
- [+] +=, ...
- [+] show whitespaces, but ignore the ones before indentation
- [+] move some builtins to prelude
- [+] prelude
- [+] concat multiple files
- [+] out of order definitions
    - [+] declare_func, define_func
- [+] compile to wasm
    - https://blog.scottlogic.com/2019/05/17/webassembly-compiler.html
    - https://gist.github.com/AlexAltea/78e8da45e20fdb1bf2afb8816de53bae
    - [+] emit empty module
    - [+] emit module with empty function
        - [+] emit type
        - [+] emit func
        - [+] emit code
    - [+] export and call function
    - [+] import log_int function
    - [+] import log string function
        - need to provide a pointer to memory
    - [+] compile ast
        - [+] print
            - [+] istr
                - [+] uint_to_string
                - [+] uint_to_string as function
- [+] textual func names
- [+] change syntax of functions to id[]
- [+] function definitions
- [+] function calls
- [+] eq op
- [+] return
- [+] if
- [+] loop
- [+] recursion
- [+] remove istring from parsing
- [+] fib function
- [+] local scopes
    - [+] block node
    - [+] local variables
- [+] disabled blocks
- [+] global mutable variables
- [+] immediate execution (not lazy)
- [+] store pattern as list, use string literals
- [+] rework ast, so that it's executable
- [+] display ast
- [+] execute
- [+] definitions pass
- [+] support both brackets on the same symbol
- [+] display node tree
    - [+] specify    node tree
    - [+] parse into node tree
    - [+] rasterize  node tree
- [+] draw line numbers
- [+] align arena allocations
- [+] measure performance
    - [+] write timestamp queries
    - [+] debug panel
    - [+] display gpu time in the debug window
    - [+] timing string in a compute shader
- [+] round inlays
- [+] wgsl files
- [+] display nesting inlays
- [+] display text colors
- [+] display text view
    - [+] text represented as a set of glyph ids
- [+] dpi aware resolution
- [+] alpha blend